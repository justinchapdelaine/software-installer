<!doctype html>
<html>

    <!-- 
    Tool to install various Windows Applications.

    Author: Justin Chapdelaine
    Source: https://github.com/justinchapdelaine/software-installer

    This is a program created with HTAs (HTML Applications). 
    https://docs.microsoft.com/en-us/previous-versions//ms536496(v=vs.85) 
    -->

    <head>
        <!--
        @tag hta:application

        @attribute ApplicationName	Sets the name of the HTA.

        @attribute Border			[Thick]|Thin|None
        @attribute BorderStyle		[Normal]|Raised|Sunken|Complex|Static
        @attribute Caption			[Yes]|No
        @attribute ContextMenu		[Yes]|No
        @attribute Icon				Path/To/Icon.ico
        @attribute MaximizeButton	[Yes]|No
        @attribute MinimizeButton	[Yes]|No
        @attribute Navigable		[Yes]|No
        @attribute Scroll			[Auto]|Yes|No
        @attribute Selection		[Yes]|No
        @attribute ShowInTaskbar	[Yes]|No
        @attribute SingleInstance	[Yes]|No
        @attribute SysMenu			[Yes]|No (Setting to No will remove close button)
        @attribute WindowsState		[Normal]|Minimize|Maximize
        -->
        <hta:application
            ID="elevate"
            ApplicationName="Software Installer"
            Icon=""
            Scroll="Yes"
        >

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=8" />
        <meta name="description" content="Tool to install various Windows Applications.">

        <title>Software Installer</title>

        <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css" integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
        
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-old-ie-min.css">
        <![endif]-->
        <!--[if gt IE 8]><!-->
            <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css">
        <!--<![endif]-->

    </head>

    <script language="VBScript">

        ' Set window size '
        window.resizeTo 900, 425

        ' If toolkit is not running with elevated permissions, self elevate '
        If HTAElevate() = True Then 
            ' Self Elevate '
        End If 

        Function HTAElevate() 

            Const Elev = " /elevated" 
            HTAElevate = True 

            If InStr( LCase( elevate.commandLine ), Elev) > 0 then Exit Function 

            On Error Resume Next 
                window.resizeTo width, height
            On Error GoTo 0 

            createobject("Shell.Application").ShellExecute "mshta.exe", elevate.commandLine & Elev, "", "runas", 1 

            HTAElevate = False      
            self.close 
            
        End Function    

        ' Installs all selected software '
        Sub startInstalling()
            Dim links(11)

            links(0) = "https://dl.google.com/chrome/install/latest/chrome_installer.exe"

            If software.googleChrome.Checked = True Then
                downloadFile links(0), "ChromeSetup.exe"
            End If
            

        End Sub

        ' Downloads the installer '
        Function downloadFile(ByRef link, ByRef name)
            MsgBox(link)
            MsgBox(name)

            const waitUntilFinished = true, dontShowWindow = 0, folderPath = "%localappdata%\StaplesTech\Installers\"
            dim downloader, folderCheck

            set objShell = CreateObject("Wscript.Shell")
            
            folderCheck = "if not exist " & folderPath & " ( mkdir " & folderPath & " & echo " & folderPath & " created)"
            MsgBox(folderCheck)

            downloader = "PowerShell -NoProfile -Command " & Chr(34) & "(New-Object Net.WebClient).DownloadFile('" & link & "', '" & folderPath & name & "')" & Chr(34)
            MsgBox(downloader) ' Output command for testing '


            objShell.Run "cmd /c " & folderCheck & " & " & command & " & echo. & pause"
        End Function

        ' Runs the installer '
        Function runFile()
            
        End Function

    </script>

    <body style="padding:0px 25px 0px 25px;">

        <!-- Heading -->
        <div class="pure-menu pure-menu-horizontal">
            <div class="pure-menu-heading" style="color: rgb(202, 60, 60); padding:0px;"><h2>Software Installer</h2></div>
            <div class="pure-menu-item" style="color: rgb(128,128,128); padding:0px;"><p>|</p></div>
            <div class="pure-menu-item" style="color: rgb(128,128,128); padding:0px;"><p>for various Windows Applications</p></div>
        </div>

        <!-- Software Selection -->
        <div class="pure-form pure-g">
            <form class="pure-form" name="software">
                <!-- Web Browsers -->
                <div class="pure-u-1-3">
                    <fieldset><legend>Web Browsers</legend></fieldset>
                    <label for="webBrowsers" class="pure-checkbox">
                        <div class="pure-u-1"><input id="googleChrome" type="checkbox"> Google Chrome</div>
                        <div class="pure-u-1"><input id="microsoftEdge" type="checkbox"> Microsoft Edge Chromium</div>
                        <div class="pure-u-1"><input id="mozillaFirefox" type="checkbox"> Mozilla Firefox</div>
                    </label>
                </div>

                <!-- Utilities -->
                <div class="pure-u-1-3">
                    <fieldset><legend>Utilities</legend></fieldset>
                    <label for="utilities" class="pure-checkbox">
                        <div class="pure-u-1"><input id="sevenZip" type="checkbox"> 7-zip File Manager</div>
                        <div class="pure-u-1"><input id="adobeReader" type="checkbox"> Adobe Reader DC</div>
                        <div class="pure-u-1"><input id="java" type="checkbox"> Java</div>
                        <div class="pure-u-1"><input id="vlc" type="checkbox"> VLC Media Player</div>
                    </label>
                </div>

                <!-- Security Suites -->
                <div class="pure-u-1-3">
                    <fieldset><legend>Security Suites</legend></fieldset>
                    <label for="utilities" class="pure-checkbox">
                        <div class="pure-u-1"><input id="nortonSecurity" type="checkbox"> Norton Security 360</div>
                        <div class="pure-u-1"><input id="kasperskySecurity" type="checkbox"> Kaspersky Internet Security</div>
                        <div class="pure-u-1"><input id="mcafeeSecurity" type="checkbox"> McAfee Total Security</div>
                        <div class="pure-u-1"><input id="malwarebytes" type="checkbox"> Malwarebytes Anti-Malware</div>
                    </label>
                </div>
            
                <!-- Begin Installation -->
                <br><br>
                <div class="pure-u-1"><button class="pure-button pure-button-primary" name="start" id="start" onclick="startInstalling()">Start Installation</button></div>
            </form>
        </div><br>

        <!-- Link to GitHub -->
        <div class="footer" style="color: rgb(211,211,211); font-size: .75em; text-align: center; padding: 0px; margin: auto">
            <div class="pure-menu pure-menu-horizontal">
                <li class="pure-menu-item"><a href="https://github.com/justinchapdelaine/software-installer" class="pure-menu-link" style="padding: 0px;">Found a bug or have a suggestion? Head on over to the GitHub!</a></li>
            </div>
        </div>

    </body>
</html>